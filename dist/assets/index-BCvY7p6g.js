import{j as e,r as m}from"./react-Bc9cU3dT.js";import{c as _}from"./react-dom-CRy70Jjt.js";import{i as G,g as T,a as Z,s as H,b as K,c as Q,d as W,e as I,f as Y,h as B,u as X,j as ee,k as se,o as te}from"./@firebase-DGoWsZDL.js";import"./firebase-DOlyPOPg.js";import{u as q,O as ae,B as re,R as oe,a as E,N as F}from"./react-router-BNkN7gbz.js";import{u as J}from"./react-hook-form-BtEtpcFR.js";import{L as $}from"./leaflet-BtYbqyVs.js";import{M as le,T as ne,a as de,P as ie}from"./react-leaflet-BFxg0Q4o.js";import"./cookie-Ddo6p1Qn.js";import"./scheduler-CylivXx-.js";import"./tslib-BGVaTf34.js";import"./idb-BXWtuYvb.js";import"./@react-leaflet-C_T2NUP0.js";(function(){const x=document.createElement("link").relList;if(x&&x.supports&&x.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const b of n.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&r(b)}).observe(document,{childList:!0,subtree:!0});function d(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(a){if(a.ep)return;a.ep=!0;const n=d(a);fetch(a.href,n)}})();const ce={apiKey:"AIzaSyB78mHklLc5tE9m9Y0GkmwVAZedeOJTtFQ",authDomain:"botbiproyecto.firebaseapp.com",projectId:"botbiproyecto",storageBucket:"botbiproyecto.appspot.com",messagingSenderId:"355204536012",appId:"1:355204536012:web:d7cfbc552950dd8f01d469"},V=G(ce),D=T(V),P=Z(V),O="/botbiProyecto/assets/botbiLogo2-BF7B159i.png";function ue({isOpen:t,setIsOpen:x}){const d=q(),r=async()=>{try{await H(D),d("/login")}catch(a){console.error("Error logging out:",a)}};return e.jsx("div",{className:`${t?"w-64":"w-20"} bg-blue-800 text-white transition-all duration-300 ease-in-out relative`,children:e.jsx("div",{className:"p-4",children:e.jsxs("nav",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("button",{onClick:()=>d("/"),className:"flex justify-center",children:e.jsx("img",{src:O,alt:"BotBI Logo",className:"w-16 h-auto"})}),e.jsx("button",{onClick:()=>x(!t),className:"p-2 rounded-lg hover:bg-blue-700 w-full flex justify-center",children:e.jsx("span",{className:"material-icons text-white",children:t?"menu_open":"menu"})})]}),e.jsxs("button",{onClick:()=>d("/clients"),className:"flex items-center w-full p-3 rounded hover:bg-blue-700 transition-colors",children:[e.jsx("span",{className:"material-icons mr-3",children:"people"}),t&&e.jsx("span",{children:"Clients"})]}),e.jsxs("button",{onClick:()=>d("/dashboard"),className:"flex items-center w-full p-3 rounded hover:bg-blue-700 transition-colors",children:[e.jsx("span",{className:"material-icons mr-3",children:"dashboard"}),t&&e.jsx("span",{children:"Dashboard"})]}),e.jsxs("button",{onClick:r,className:"flex items-center w-full p-3 rounded hover:bg-blue-700 transition-colors mt-auto",children:[e.jsx("span",{className:"material-icons mr-3",children:"logout"}),t&&e.jsx("span",{children:"Logout"})]})]})})})}const me=()=>{const[t,x]=m.useState(!0);return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ue,{isOpen:t,setIsOpen:x}),e.jsx("div",{className:"flex-1 p-8",children:e.jsx(ae,{})})]})},xe="/botbiProyecto/assets/botbiLogo-DWxqo6sQ.png";function he(){const[t,x]=m.useState(!0),[d,r]=m.useState(!1),[a,n]=m.useState(""),b=q(),{register:i,handleSubmit:C,formState:{errors:g}}=J(),o=async h=>{r(!0),n("");try{if(t)await K(D,h.email,h.password),b("/");else{const N=await Q(D,h.email,h.password);await W(I(P,"users",N.user.uid),{email:h.email,firstName:h.firstName,lastName:h.lastName,birthDate:h.birthDate,createdAt:new Date().toISOString()}),b("/")}}catch(N){n(N.message)}finally{r(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 p-10 bg-white rounded-xl shadow-lg",children:[e.jsxs("div",{children:[e.jsx("img",{className:"mx-auto h-24 w-auto",src:xe,alt:"Botbi Logo"}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:t?"Sign in to your account":"Create new account"})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:C(o),children:[e.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[!t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("input",{...i("firstName",{required:"First name is required"}),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"First Name"}),g.firstName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:g.firstName.message})]}),e.jsxs("div",{children:[e.jsx("input",{...i("lastName",{required:"Last name is required"}),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Last Name"}),g.lastName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:g.lastName.message})]}),e.jsxs("div",{children:[e.jsx("input",{type:"date",...i("birthDate",{required:"Birth date is required"}),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"}),g.birthDate&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:g.birthDate.message})]})]}),e.jsxs("div",{children:[e.jsx("input",{...i("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address"}),g.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:g.email.message})]}),e.jsxs("div",{children:[e.jsx("input",{type:"password",...i("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password"}),g.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:g.password.message})]})]}),a&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:e.jsx("span",{className:"block sm:inline",children:a})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:d,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white ${d?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`,children:d?"Processing...":t?"Sign in":"Sign up"})})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-500",onClick:()=>x(!t),children:t?"Need an account? Sign up":"Already have an account? Sign in"})})]})})}const pe={Coahuila:{Torreón:["Campestre La Rosita","Centro","Jardines de California","La amistad","La Fuente","La Joya","La Merced","La Paz","La Perla","Las Etnias","Las Fuentes","Nueva Los Ángeles","Residencial Campestre","Residencial El Fresno","Residencial del Norte","Residencial Senderos","Rincón La Merced","Roma","San Isidro"].sort(),Saltillo:["Centro","La Aurora","La Fuente","La Herradura","La Joya","La Paz","La Perla","La Rosita","Lomas de Lourdes","Los Olivos","Los Pinos","Los Reales","Los Rodríguez","San Patricio","Valle Real","Valle de las Flores"].sort(),Monclova:["Centro","El Pueblo","Estancias de Santa Ana","Guadalupe","La Fuente","La Joya","La Loma","La Paz","La Perla","La Rosita","La Victoria","Las Palmas","Privada del Este","Privada del Norte","Privada del Oeste","Privada del Sur","San Miguel"].sort()},"Nuevo León":{Monterrey:["Centro","Contry","Cumbres","Del Valle","La Alianza","La Aurora","La Estanzuela","La Fama","La Herradura","La Joya","La Paz","Mitras Centro","Mitras Norte","Mitras Sur","Obispado","San Jerónimo","Vista Hermosa"].sort(),Guadalupe:["Contry","Jardines de Guadalupe","La Alianza","La Aurora","La Estanzuela","La Fama","La Herradura","La Joya","La Paz","La Pastora","La Perla","La Purísima","Linda Vista","Las Quintas","Rincón de la Sierra","Valle Soleado","La Silla"].sort()},Durango:{Durango:["Benito Juárez","Centro","Francisco Villa","Guadalupe Victoria","Jardines","La Alianza","La Aurora","La Estanzuela","La Fama","La Herradura","La Joya","La Paz","Las Alamedas","Lomas de San Juan","Lomas del Parque","Lomas del Valle"].sort(),Lerdo:["César Guillermo","Centro","La Alianza","La Aurora","La Estanzuela","La Fama","La Herradura","La Joya","La Paz","San Antonio","San Fernando","San Isidro","San José","San Juan","San Miguel","San Pedro","Villa Jardín"].sort()}},z={México:pe},ge="AIzaSyAdt9kEbALdED6sjEnEpDJcg0dAhropseg";function be(){const[t,x]=m.useState(!1),[d,r]=m.useState(!1),[a,n]=m.useState(""),b=q(),{register:i,handleSubmit:C,reset:g,formState:{errors:o}}=J(),[h,N]=m.useState(""),[y,k]=m.useState(""),[w,S]=m.useState(""),A=h?Object.keys(z[h]):[],l=y?Object.keys(z[h][y]):[],f=w?z[h][y][w]:[],c=async s=>{try{const u=await fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(s)}&region=mx&language=es&key=${ge}`);if(!u.ok)throw new Error("Network response was not ok");const j=await u.json();if(j.status==="ZERO_RESULTS")throw new Error("Dirección no encontrada");if(j.status!=="OK")throw console.error("Google Maps API response:",j),new Error("Error al obtener las coordenadas");const{lat:v,lng:L}=j.results[0].geometry.location;return console.log("Coordenadas encontradas:",{lat:v,lng:L}),{latitude:v,longitude:L}}catch(u){return console.error("Error al obtener coordenadas:",u),{latitude:23.634501,longitude:-102.552784}}},p=async s=>{x(!0),n("");try{const u=`${s.street} ${s.number}, ${s.neighborhood}, ${w}, ${y}, ${h} ${s.postalCode}`;console.log("Buscando coordenadas para:",u);let j;try{j=await c(u)}catch(U){console.warn("Error al obtener coordenadas:",U),j={latitude:23.634501,longitude:-102.552784}}const v={street:s.street,number:s.number,neighborhood:s.neighborhood,city:w,state:y,country:h,postalCode:s.postalCode,fullAddress:u,coordinates:j},L={firstName:s.firstName,lastName:s.lastName,email:s.email,phone:s.phone,address:v,createdAt:new Date().toISOString()};await Y(B(P,"clients"),L),r(!0),g()}catch(u){n(`Error: ${u.message}`),console.error("Error adding client:",u)}finally{x(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("nav",{className:"bg-blue-800 text-white p-4 h-16 flex items-center",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("img",{src:O,alt:"BotBI Logo",className:"w-20 h-auto cursor-pointer -my-6",onClick:()=>b("/")}),e.jsx("h1",{className:"text-2xl font-bold",children:"Client Management"}),e.jsx("div",{className:"w-20"})," "]})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Add New Client"}),e.jsxs("form",{onSubmit:C(p),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),e.jsx("input",{...i("firstName",{required:"First name is required"}),placeholder:"Carlos",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),o.firstName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.firstName.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),e.jsx("input",{...i("lastName",{required:"Last name is required"}),placeholder:"Delgado",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),o.lastName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.lastName.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",...i("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),placeholder:"carlos@correo.com",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),o.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),e.jsx("input",{...i("phone",{required:"Phone is required"}),placeholder:"+52 55 1234 5678",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),o.phone&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.phone.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Street"}),e.jsx("input",{...i("street",{required:"Street is required"}),placeholder:"Calle principal 123",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),o.street&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.street.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Number"}),e.jsx("input",{...i("number",{required:"Number is required"}),placeholder:" Apt 4B",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),o.number&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.number.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Country"}),e.jsxs("select",{...i("country",{required:"Country is required"}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",onChange:s=>{N(s.target.value),k(""),S("")},children:[e.jsx("option",{value:"",children:"Select Country"}),e.jsx("option",{value:"México",children:"México"})]}),o.country&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.country.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"State"}),e.jsxs("select",{...i("state",{required:"State is required"}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",onChange:s=>{k(s.target.value),S("")},disabled:!h,children:[e.jsx("option",{value:"",children:"Select State"}),A.map(s=>e.jsx("option",{value:s,children:s},s))]}),o.state&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.state.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),e.jsxs("select",{...i("city",{required:"City is required"}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",onChange:s=>S(s.target.value),disabled:!y,children:[e.jsx("option",{value:"",children:"Select City"}),l.map(s=>e.jsx("option",{value:s,children:s},s))]}),o.city&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.city.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Neighborhood"}),e.jsxs("select",{...i("neighborhood",{required:"Neighborhood is required"}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",disabled:!w,children:[e.jsx("option",{value:"",children:"Select Neighborhood"}),f.map(s=>e.jsx("option",{value:s,children:s},s))]}),o.neighborhood&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.neighborhood.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Postal Code"}),e.jsx("input",{...i("postalCode",{required:"Postal code is required"}),placeholder:"2700",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),o.postalCode&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.postalCode.message})]})]}),a&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:a}),d&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative",children:"Client added successfully!"}),e.jsx("button",{type:"submit",disabled:t,className:`w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${t?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`,children:t?"Adding...":"Add Client"})]})]})})]})}const R={lat:23.634501,lng:-102.552784};function fe({client:t,closeModal:x,isEditing:d}){var h,N,y,k,w,S,A,l,f;const[r,a]=m.useState({...t}),n=c=>{const{name:p,value:s}=c.target;a({...r,[p]:s})},b=c=>{const{name:p,value:s}=c.target;a({...r,address:{...r.address,[p]:s}})},i=async c=>{c.preventDefault();try{const p={...r,address:{...r.address,latitude:parseFloat(r.address.latitude),longitude:parseFloat(r.address.longitude)}},s=I(P,"clients",t.id);await X(s,p),x()}catch(p){console.error("Error updating client:",p)}},C=c=>{if(!c.address)return"No address provided";const p=c.address.street||"",s=c.address.number||"",u=c.address.city||"";return[p,s,u].filter(Boolean).join(", ")||"No address provided"},g=c=>{var u,j,v,L;const p=parseFloat((j=(u=c.address)==null?void 0:u.coordinates)==null?void 0:j.latitude)||R.lat,s=parseFloat((L=(v=c.address)==null?void 0:v.coordinates)==null?void 0:L.longitude)||R.lng;return[p,s]},o=c=>{var u,j,v,L;const p=(j=(u=c.address)==null?void 0:u.coordinates)==null?void 0:j.latitude,s=(L=(v=c.address)==null?void 0:v.coordinates)==null?void 0:L.longitude;return p&&s?`${parseFloat(p).toFixed(7)}, ${parseFloat(s).toFixed(7)}`:"No coordinates available"};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:d?"Edit Client":"Client Details"}),e.jsx("button",{onClick:x,className:"text-gray-500 hover:text-gray-700",children:e.jsx("span",{className:"material-icons",children:"close"})})]}),e.jsxs("form",{onSubmit:i,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"First Name"}),e.jsx("input",{type:"text",name:"firstName",value:r.firstName,onChange:n,className:"w-full px-3 py-2 border rounded-lg",disabled:!d})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Last Name"}),e.jsx("input",{type:"text",name:"lastName",value:r.lastName,onChange:n,className:"w-full px-3 py-2 border rounded-lg",disabled:!d})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:n,className:"w-full px-3 py-2 border rounded-lg",disabled:!d})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Phone"}),e.jsx("input",{type:"text",name:"phone",value:r.phone,onChange:n,className:"w-full px-3 py-2 border rounded-lg",disabled:!d})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Address"}),d?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",name:"street",value:((h=r.address)==null?void 0:h.street)||"",onChange:b,className:"w-full px-3 py-2 border rounded-lg mb-2",placeholder:"Street"}),e.jsx("input",{type:"text",name:"number",value:((N=r.address)==null?void 0:N.number)||"",onChange:b,className:"w-full px-3 py-2 border rounded-lg mb-2",placeholder:"Number"}),e.jsx("input",{type:"text",name:"city",value:((y=r.address)==null?void 0:y.city)||"",onChange:b,className:"w-full px-3 py-2 border rounded-lg mb-2",placeholder:"City"}),e.jsx("input",{type:"text",name:"latitude",value:((k=r.address)==null?void 0:k.latitude)||"",onChange:b,className:"w-full px-3 py-2 border rounded-lg mb-2",placeholder:"Latitude"}),e.jsx("input",{type:"text",name:"longitude",value:((w=r.address)==null?void 0:w.longitude)||"",onChange:b,className:"w-full px-3 py-2 border rounded-lg mb-2",placeholder:"Longitude"})]}):e.jsx("p",{children:C(t)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Coordinates"}),e.jsx("p",{className:"text-sm font-mono bg-gray-100 p-2 rounded",children:o(t)}),(!((A=(S=t.address)==null?void 0:S.coordinates)!=null&&A.latitude)||!((f=(l=t.address)==null?void 0:l.coordinates)!=null&&f.longitude))&&e.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"Using default location (Mexico City)"})]})]}),e.jsx("div",{className:"h-[400px] z-0",children:e.jsxs(le,{center:g(t),zoom:15,style:{height:"100%",width:"100%"},className:"rounded-lg shadow-md",children:[e.jsx(ne,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),e.jsx(de,{position:g(t),children:e.jsx(ie,{children:C(t)})})]})})]}),e.jsxs("div",{className:"flex justify-end mt-4",children:[e.jsx("button",{type:"button",onClick:x,className:"bg-gray-500 text-white px-4 py-2 rounded-lg mr-2",children:"Cancel"}),d&&e.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg",children:"Save"})]})]})]})})})}delete $.Icon.Default.prototype._getIconUrl;$.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const M={lat:25.5530571,lng:-103.3606319};function je(){const[t,x]=m.useState([]),[d,r]=m.useState(!0),[a,n]=m.useState(""),[b,i]=m.useState(null),[C,g]=m.useState(!1),[o,h]=m.useState(!1),N=q();m.useEffect(()=>{y()},[]);const y=async()=>{try{const l=B(P,"clients"),c=(await ee(l)).docs.map(p=>{var u,j;const s=p.data();return{id:p.id,...s,address:{...s.address,latitude:((u=s.address)==null?void 0:u.latitude)||M.lat,longitude:((j=s.address)==null?void 0:j.longitude)||M.lng}}});x(c)}catch(l){n("Error fetching clients"),console.error("Error fetching clients:",l)}finally{r(!1)}},k=async l=>{if(window.confirm("Are you sure you want to delete this client?"))try{await se(I(P,"clients",l)),x(t.filter(f=>f.id!==l))}catch(f){n("Error deleting client"),console.error("Error deleting client:",f)}},w=(l,f=!1)=>{i(l),h(f),g(!0)},S=()=>{g(!1),i(null),y()},A=l=>{if(!l.address)return"No address provided";const f=l.address.street||"",c=l.address.number||"",p=l.address.city||"";return[f,c,p].filter(Boolean).join(", ")||"No address provided"};return d?e.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading..."}):e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("nav",{className:"bg-blue-800 text-white p-4 h-16 flex items-center",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("button",{onClick:()=>N("/"),className:"flex justify-center",children:e.jsx("img",{src:O,alt:"BotBI Logo",className:"w-20 h-auto cursor-pointer -my-6"})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Client Dashboard"}),e.jsx("div",{className:"w-20"})]})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Clients List"}),e.jsx("button",{onClick:()=>N("/clients"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Add New Client"})]}),a&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:a}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(l=>e.jsxs("tr",{onClick:()=>w(l),className:"hover:bg-gray-50 cursor-pointer",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.firstName||""," ",l.lastName||""]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.email||"No email"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.phone||"No phone"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:A(l)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap space-x-2",children:[e.jsx("button",{onClick:f=>{f.stopPropagation(),w(l,!0)},className:"text-indigo-600 hover:text-indigo-900 mr-4",children:e.jsx("span",{className:"material-icons",children:"edit"})}),e.jsx("button",{onClick:f=>{f.stopPropagation(),k(l.id)},className:"text-red-600 hover:text-red-900",children:e.jsx("span",{className:"material-icons",children:"delete"})})]})]},l.id))})]})})]})}),C&&b&&e.jsx(fe,{client:b,closeModal:S,isEditing:o})]})}function ye(){const[t,x]=m.useState(null),[d,r]=m.useState(!0);return m.useEffect(()=>{const a=te(D,n=>{x(n),r(!1)});return()=>a()},[]),d?e.jsx("div",{children:"Loading..."}):e.jsx(re,{children:e.jsxs(oe,{children:[e.jsx(E,{path:"/login",element:t?e.jsx(F,{to:"/"}):e.jsx(he,{})}),e.jsxs(E,{element:t?e.jsx(me,{}):e.jsx(F,{to:"/login"}),children:[e.jsx(E,{path:"/",element:e.jsx(F,{to:"/dashboard"})}),e.jsx(E,{path:"/clients",element:e.jsx(be,{})}),e.jsx(E,{path:"/dashboard",element:e.jsx(je,{})})]})]})})}_(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx(ye,{})}));
